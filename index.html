<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>MUBES KSPM UTY 2025</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: Arial, sans-serif; background:#f8fafc; margin:0; }
    header { background:#111827; color:#fff; padding:14px 20px; }
    header h1 { margin:0; font-size:20px; }
    .container { max-width: 900px; margin:20px auto; padding:20px; background:#fff; border-radius:12px; box-shadow:0 4px 16px rgba(0,0,0,.1);}
    h2 { margin-top:0; }
    label { font-weight:bold; display:block; margin:12px 0 4px; }
    input { width:100%; padding:10px; border:1px solid #ccc; border-radius:8px; }
    button { padding:10px 14px; border:none; border-radius:8px; margin-top:16px; font-weight:bold; cursor:pointer; }
    button.primary { background:#111827; color:#fff; }
    button.disabled { background:#9ca3af; color:#fff; cursor:not-allowed; }
    .hidden { display:none; }
    nav button { margin-right:8px; }
    .pasal { margin:16px 0; padding:10px; border:1px solid #ddd; border-radius:8px; }
    .ayat { margin:8px 0; padding:8px; border:1px solid #eee; border-radius:6px; }
    .vote-btn { margin:4px; padding:6px 10px; border-radius:6px; border:1px solid #ccc; cursor:pointer; font-size:12px; }
    .vote-btn.active { background:#111827; color:#fff; }
    .calon { display:inline-block; width:220px; margin:10px; padding:10px; border:1px solid #ddd; border-radius:8px; text-align:center; vertical-align:top; cursor:pointer; }
    .calon img { width:100%; height:180px; object-fit:cover; border-radius:8px; }
    .result { font-weight:bold; margin-top:10px; }
  </style>
</head>
<body>

<header>
  <h1>MUBES KSPM UTY 2025</h1>
</header>

<!-- LOGIN -->
<div class="container" id="login-view">
  <h2>Login</h2>
  <label>NIM</label>
  <input type="text" id="nim">
  <label>Tanggal Lahir (YYYY-MM-DD)</label>
  <input type="date" id="dob">
  <div id="login-error" style="color:red; display:none;">NIM atau Tanggal Lahir salah!</div>
  <button class="primary" onclick="login()">Masuk</button>
</div>

<!-- BERANDA -->
<div class="container hidden" id="home-view">
  <h2>Beranda</h2>
  <p>Selamat datang, <span id="user-name"></span>!</p>
  <nav>
    <button class="primary" onclick="showADART()">Pengesahan AD/ART</button>
    <button id="btn-ketua" class="disabled">Pemilihan Ketua</button>
    <button onclick="logout()">Keluar</button>
  </nav>
</div>

<!-- AD ART -->
<div class="container hidden" id="adart-view">
  <h2>Pengesahan AD/ART</h2>
  <p>Pilih sikap untuk setiap ayat (Setuju / Tidak / Tunda).</p>
  <div id="adart-list"></div>
  <button class="primary" onclick="finishADART()">Selesai Pengesahan</button>
</div>

<!-- KETUA -->
<div class="container hidden" id="ketua-view">
  <h2>Pemilihan Ketua</h2>
  <p>Pilih salah satu calon ketua kemudian klik <b>Submit Pilihan</b>.</p>
  <div id="calon-list"></div>
  <button id="btn-submit-ketua" class="primary" onclick="submitKetua()">Submit Pilihan</button>
  <div id="ketua-result" class="result">Belum memilih</div>
  <button onclick="backHome()">Kembali</button>
</div>

<script>
  // ==== DATA DEMO ====
  const USERS = [
    { nim:"21515001", dob:"2003-04-12", name:"Aisyah" },
    { nim:"21515002", dob:"2003-10-21", name:"Bagas" }
  ];

  const ADART = [
    { pasal:"Pasal 1", ayat:["Ayat 1: Nama dan Kedudukan","Ayat 2: Sifat dan Asas"] },
    { pasal:"Pasal 2", ayat:["Ayat 1: Keanggotaan","Ayat 2: Hak dan Kewajiban"] }
  ];

  const KETUA = [
    { id:"c1", nama:"Calon 1", foto:"calon1.jpg", visi:"Meningkatkan solidaritas." },
    { id:"c2", nama:"Calon 2", foto:"calon2.jpg", visi:"Mendorong inovasi." },
    { id:"c3", nama:"Calon 3", foto:"calon3.jpg", visi:"Transparansi & akuntabilitas." }
  ];

  let currentUser = null;
  let adartDone = false;
  let selectedKetua = null;

  // ==== LOGIN ====
  function login(){
    const nim = document.getElementById('nim').value.trim();
    const dob = document.getElementById('dob').value.trim();
    const user = USERS.find(u=>u.nim===nim && u.dob===dob);
    if(!user){ document.getElementById('login-error').style.display='block'; return;}
    currentUser = user;
    document.getElementById('login-view').classList.add('hidden');
    document.getElementById('home-view').classList.remove('hidden');
    document.getElementById('user-name').innerText=user.name;
  }

  function logout(){
    currentUser=null; adartDone=false; selectedKetua=null;
    document.getElementById('home-view').classList.add('hidden');
    document.getElementById('adart-view').classList.add('hidden');
    document.getElementById('ketua-view').classList.add('hidden');
    document.getElementById('login-view').classList.remove('hidden');
    document.getElementById('nim').value='';
    document.getElementById('dob').value='';
    document.getElementById('btn-ketua').className="disabled";
    document.getElementById('btn-ketua').onclick=null;
  }

  // ==== ADART ====
  function showADART(){
    document.getElementById('home-view').classList.add('hidden');
    document.getElementById('adart-view').classList.remove('hidden');
    renderADART();
  }

  function renderADART(){
    const container = document.getElementById('adart-list');
    container.innerHTML='';
    ADART.forEach((p,pi)=>{
      const div = document.createElement('div');
      div.className='pasal';
      div.innerHTML=`<h3>${p.pasal}</h3>`;
      p.ayat.forEach((a,ai)=>{
        const ayatDiv = document.createElement('div');
        ayatDiv.className='ayat';
        ayatDiv.innerHTML=`<div>${a}</div>`;
        ['Setuju','Tidak','Tunda'].forEach(opt=>{
          const b = document.createElement('button');
          b.className='vote-btn';
          b.innerText=opt;
          b.onclick=()=>{
            localStorage.setItem(`${currentUser.nim}_p${pi}_a${ai}`, opt);
            ayatDiv.querySelectorAll('.vote-btn').forEach(x=>x.classList.remove('active'));
            b.classList.add('active');
          };
          ayatDiv.appendChild(b);
        });
        div.appendChild(ayatDiv);
      });
      container.appendChild(div);
    });
  }

  function finishADART(){
    let allVoted = true;
    ADART.forEach((p,pi)=>{
      p.ayat.forEach((a,ai)=>{
        if(!localStorage.getItem(`${currentUser.nim}_p${pi}_a${ai}`)){ allVoted=false; }
      });
    });
    if(!allVoted){ alert("Harap pilih semua ayat terlebih dahulu."); return;}
    adartDone=true;
    document.getElementById('adart-view').classList.add('hidden');
    document.getElementById('home-view').classList.remove('hidden');
    document.getElementById('btn-ketua').className="primary";
    document.getElementById('btn-ketua').onclick=showKetua;
  }

  // ==== KETUA ====
  function showKetua(){
    if(!adartDone){ alert("Selesaikan pengesahan AD/ART terlebih dahulu."); return;}
    document.getElementById('home-view').classList.add('hidden');
    document.getElementById('ketua-view').classList.remove('hidden');
    renderKetua();
  }

  function renderKetua(){
    const list = document.getElementById('calon-list');
    list.innerHTML='';
    selectedKetua = null;
    document.getElementById('ketua-result').innerText="Belum memilih";

    KETUA.forEach(c=>{
      const div = document.createElement('div');
      div.className='calon';
      div.innerHTML=`
        <img src="${c.foto}" alt="${c.nama}">
        <h4>${c.nama}</h4>
        <p>${c.visi}</p>
      `;
      div.onclick=()=>{
        selectedKetua = c;
        list.querySelectorAll('.calon').forEach(x=>x.style.borderColor='#ddd');
        div.style.borderColor='green';
      };
      list.appendChild(div);
    });
  }

  function submitKetua(){
    if(!selectedKetua){ alert("Silakan pilih salah satu calon terlebih dahulu!"); return; }
    localStorage.setItem(`${currentUser.nim}_ketua`, selectedKetua.id);
    document.getElementById('ketua-result').innerText="Pilihan Ketua: "+selectedKetua.nama;
    alert("Pilihan berhasil disubmit!");
  }

  function backHome(){
    document.getElementById('ketua-view').classList.add('hidden');
    document.getElementById('home-view').classList.remove('hidden');
  }
</script>

</body>
</html>
